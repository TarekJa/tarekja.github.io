<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="description" content="حاسبة العمر المباشر بالثواني والدقائق والساعات والأيام. أدخل تاريخ ووقت الميلاد وشاهد العمر يتحدث لحظيًا.">
  <meta name="robots" content="index,follow">
  <meta name="theme-color" content="#0f172a">

  <link rel="canonical" href="https://tarekja.github.io/">
  <link rel="icon" href="favicon.ico">
  <link rel="apple-touch-icon" href="favicon-512.png">

  <meta property="og:title" content="Live Age Calculator | حاسبة العمر المباشر">
  <meta property="og:description" content="احسب عمرك بشكل مباشر بالسنوات والأشهر والأيام والساعات والدقائق والثواني.">
  <meta property="og:url" content="https://tarekja.github.io/">
  <meta property="og:type" content="website">

  <!-- Google Analytics (مرة واحدة فقط) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FZ91MD319E"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-FZ91MD319E', { anonymize_ip: true });
  </script>

  <!-- Google AdSense -->
  <meta name="google-adsense-account" content="ca-pub-3878960602510145">
  <script async
          src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3878960602510145"
          crossorigin="anonymous"></script>

  <title>Live Age Calculator | حاسبة العمر المباشر</title>

  <style>
    :root{
      color-scheme: dark;

      --bg:#0f172a;
      --panel:#020617;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --accent:#38bdf8;
      --line:#1e293b;

      --btn:#38bdf8;
      --btnText:#0b1220;
      --btnGhostBorder:#1e293b;
      --danger:#fb7185;
      --ok:#34d399;
    }

    body{
      font-family: Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      margin:0;
      padding:0;
    }

    .page{
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:center;
      padding: 18px 10px;
    }

    .container{
      width: min(560px, 92vw);
      margin: 0 auto;
    }

    .box{
      background: var(--panel);
      padding: 24px;
      border-radius:16px;
      box-shadow:0 0 40px rgba(0,0,0,0.7);
    }

    .topbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-bottom: 10px;
    }

    .lang-wrap{
      display:flex;
      align-items:center;
      gap:8px;
      color: var(--muted);
      font-size: 13px;
    }

    select{
      background: rgba(255,255,255,0.06);
      color: var(--text);
      border: 1px solid var(--line);
      border-radius: 10px;
      padding: 8px 10px;
      outline:none;
      cursor:pointer;
      appearance: none;
    }
    option{
      background: #0b1220;
      color: var(--text);
    }

    .share-wrap{
      display:flex;
      align-items:center;
      gap:8px;
    }

    .icon-btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      background: rgba(255,255,255,0.06);
      color: var(--text);
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 8px 10px;
      cursor: pointer;
      user-select:none;
    }
    .icon-btn:hover{ opacity: 0.92; }
    .icon{
      width:18px;
      height:18px;
      display:inline-block;
    }
    .icon svg{ width:18px; height:18px; fill: currentColor; }

    h1{
      text-align:center;
      margin:0 0 16px 0;
      font-size:22px;
      color: var(--accent);
    }

    .subnote{
      text-align:center;
      color: var(--muted);
      font-size: 13px;
      margin: -6px 0 16px 0;
      line-height: 1.5;
    }

    .field{ margin-bottom: 12px; }

    label{
      display:block;
      margin-bottom:5px;
      color: var(--muted);
      font-size:14px;
    }

    .hint{
      margin-top: 6px;
      font-size: 12px;
      color: var(--muted);
      line-height: 1.45;
    }

    input{
      width:100%;
      padding: 10px;
      border-radius:10px;
      border: 1px solid transparent;
      outline: none;
      font-size:14px;
      box-sizing: border-box;
    }
    input:focus{
      border-color: rgba(56,189,248,0.5);
      box-shadow: 0 0 0 3px rgba(56,189,248,0.12);
    }

    .actions{
      display:flex;
      gap:10px;
      margin-top: 10px;
    }

    button{
      flex:1;
      background: var(--btn);
      border:none;
      color: var(--btnText);
      padding:10px 12px;
      border-radius:10px;
      font-size:15px;
      cursor:pointer;
      font-weight: bold;
    }
    button.secondary{
      background: transparent;
      color: var(--text);
      border: 1px solid var(--btnGhostBorder);
      font-weight: normal;
    }
    button:hover{ opacity:0.92; }

    .result{
      margin-top:22px;
      display:none;
    }

    .row{
      display:flex;
      justify-content:space-between;
      padding: 8px 0;
      border-bottom:1px solid var(--line);
      font-size:14px;
      gap: 16px;
      align-items: baseline;
    }
    .row:last-child{ border-bottom:none; }

    .label{ color: var(--muted); }
    .value{
      font-weight:bold;
      color: var(--text);
      text-align:left;
      direction:ltr;
      white-space: nowrap;
    }

    /* Hijri block */
    .hijri-block{
      padding: 8px 0 10px 0;
      border-bottom:1px solid var(--line);
    }
    .hijri-line{
      display:flex;
      justify-content:space-between;
      gap:16px;
      font-size:14px;
      align-items: baseline;
    }
    .hijri-value{
      font-weight:bold;
      color: var(--text);
      white-space: normal;
      text-align: right;
      direction: rtl;
    }

    .toast{
      margin-top: 10px;
      display:none;
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.04);
      border-radius: 12px;
      padding: 10px 12px;
      color: var(--text);
      font-size: 13px;
      line-height: 1.6;
    }
    .toast.ok{ border-color: rgba(52,211,153,0.35); }
    .toast.err{ border-color: rgba(251,113,133,0.35); }

    .footer{
      margin-top: 16px;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.7;
    }
    .footer a{ color: var(--accent); text-decoration:none; }
    .footer a:hover{ text-decoration:underline; }

    details{
      margin-top: 10px;
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 10px 12px;
      background: rgba(2,6,23,0.4);
    }
    summary{
      cursor: pointer;
      color: var(--text);
      font-weight: bold;
    }
    details p{
      margin: 10px 0 0 0;
      color: var(--muted);
      font-weight: normal;
    }

    .contact-meta{
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid var(--line);
      line-height: 1.9;
    }

    @media (max-width: 420px){
      .box{ padding: 18px; }
      h1{ font-size: 20px; }
    }
  </style>
</head>

<body>
  <div class="page">
    <div class="container">
      <div class="box">

        <div class="topbar">
          <div class="lang-wrap">
            <span id="uiLangLabel">اللغة</span>
            <select id="langSelect" aria-label="Language selector">
              <option value="ar">العربية</option>
              <option value="tr">Türkçe</option>
              <option value="en">English</option>
            </select>
          </div>

          <div class="share-wrap">
            <button class="icon-btn" id="shareBtn" type="button" title="Share">
              <span class="icon" aria-hidden="true">
                <!-- Share icon (three nodes) -->
                <svg viewBox="0 0 24 24">
                  <path d="M18 16a3 3 0 0 0-2.4 1.2L8.9 13.9A3.1 3.1 0 0 0 9 13a3.1 3.1 0 0 0-.1-.9l6.7-3.3A3 3 0 1 0 15 6a3 3 0 0 0 .1.9L8.4 10.2A3 3 0 1 0 9 13c0-.3 0-.6-.1-.9l6.7 3.3A3 3 0 1 0 18 16z"/>
                </svg>
              </span>
              <span id="shareLabel">شارك</span>
            </button>
          </div>
        </div>

        <h1 id="title">حاسبة العمر المباشر</h1>

        <div class="subnote" id="subnote">
          أدخل تاريخ ووقت الميلاد ثم شاهد العمر يتحدث كل ثانية.<br>
          (السنوات/الأشهر تقريبية — بينما الأيام/الساعات/الدقائق/الثواني دقيقة)
        </div>

        <div class="field">
          <label for="name" id="lblName">الاسم</label>
          <input type="text" id="name" placeholder="أدخل الاسم" maxlength="40">
          <div class="hint" id="hintName">اختياري. إذا تركته فارغًا سيظهر العنوان العام بدون اسم.</div>
        </div>

        <div class="field">
          <label for="birthDate" id="lblBirthDate">تاريخ الميلاد</label>
          <input type="date" id="birthDate">
          <div class="hint" id="hintBirthDate">مطلوب. اختر التاريخ من التقويم.</div>
        </div>

        <div class="field">
          <label for="birthTime" id="lblBirthTime">ساعة الميلاد</label>
          <input type="time" id="birthTime" step="1">
          <div class="hint" id="hintBirthTime">
            اختياري. إذا تركته فارغًا سنعتبر الوقت <b>00:00:00</b>.<br>
            عادةً الإدخال يكون بنظام <b>24 ساعة</b>: مثال <b>07:30</b> (AM صباحًا) أو <b>19:30</b> (PM مساءً).
          </div>
          <div class="hint" id="timePreview"></div>
        </div>

        <div class="actions">
          <button id="btnStart" onclick="start()">احسب العمر</button>
          <button id="btnReset" class="secondary" onclick="resetApp()">مسح</button>
        </div>

        <div class="result" id="result" aria-live="polite">

          <div class="row"><div class="label" id="rYears">السنوات (تقريب)</div><div class="value" id="years"></div></div>
          <div class="row"><div class="label" id="rMonths">الأشهر (تقريب)</div><div class="value" id="months"></div></div>
          <div class="row"><div class="label" id="rWeeks">الأسابيع</div><div class="value" id="weeks"></div></div>
          <div class="row"><div class="label" id="rDays">الأيام</div><div class="value" id="days"></div></div>
          <div class="row"><div class="label" id="rHours">الساعات</div><div class="value" id="hours"></div></div>
          <div class="row"><div class="label" id="rMinutes">الدقائق</div><div class="value" id="minutes"></div></div>
          <div class="row"><div class="label" id="rSeconds">الثواني</div><div class="value" id="seconds"></div></div>

          <!-- Hijri (Umm al-Qura) -->
          <div class="hijri-block">
            <div class="hijri-line">
              <div class="label" id="rHijri">التاريخ الهجري (أم القرى)</div>
              <div class="hijri-value" id="hijri"></div>
            </div>
            <div class="hint" id="hijriHint"></div>
          </div>

          <div class="toast" id="toast"></div>
        </div>

        <div class="footer">
          <div>
            <span id="usefulLinks">روابط مفيدة:</span>
            <a href="#about" onclick="openDetails('about')" id="lnkAbout">من نحن</a> ·
            <a href="/privacy.html" id="lnkPrivacy">سياسة الخصوصية</a> ·
            <a href="#contact" onclick="openDetails('contact')" id="lnkContact">تواصل</a>
          </div>

          <details id="about">
            <summary id="sumAbout">من نحن</summary>
            <p id="aboutText">
              هذه أداة بسيطة لحساب العمر بشكل مباشر (Real-time) عبر إدخال تاريخ ووقت الميلاد.
              الهدف هو تقديم تجربة سريعة وخفيفة تعمل على الجوال والكمبيوتر.
            </p>
          </details>

          <details id="contact">
            <summary id="sumContact">تواصل</summary>
            <p id="contactIntro">إذا عندك اقتراحات أو ملاحظات على الموقع، تواصل معي عبر الوسائل التالية:</p>

            <div class="contact-meta">
              <div><b id="cNameLbl">الاسم:</b> <span id="cNameVal">Tarek Jawish</span></div>
              <div><b id="cRoleLbl">الصفة:</b> <span id="cRoleVal">MEAL Expert</span></div>
              <div><b id="cEmailLbl">البريد:</b> <a href="mailto:tarekjawish89@gmail.com">tarekjawish89@gmail.com</a></div>
              <div><b id="cLinkedLbl">LinkedIn:</b>
                <a href="https://www.linkedin.com/in/tarek-jawish-890998106/" target="_blank" rel="noopener noreferrer" id="cLinkedText">
                  الملف الشخصي
                </a>
              </div>
            </div>
          </details>
        </div>

      </div>
    </div>
  </div>

  <script>
    let interval = null;

    const STORAGE_KEYS = {
      name: "lac_name",
      date: "lac_birthDate",
      time: "lac_birthTime",
      lang: "lac_lang"
    };

    function $(id){ return document.getElementById(id); }

    function openDetails(id){
      const el = $(id);
      if (el && el.tagName.toLowerCase() === "details"){
        el.open = true;
        el.scrollIntoView({ behavior: "smooth", block: "start" });
      }
    }

    function showToast(message, kind){
      const t = $("toast");
      if (!t) return;
      t.className = "toast " + (kind || "");
      t.textContent = message;
      t.style.display = "block";
      clearTimeout(showToast._tm);
      showToast._tm = setTimeout(()=>{ t.style.display="none"; }, 3500);
    }

    function saveInputs(){
      localStorage.setItem(STORAGE_KEYS.name, $("name").value || "");
      localStorage.setItem(STORAGE_KEYS.date, $("birthDate").value || "");
      localStorage.setItem(STORAGE_KEYS.time, $("birthTime").value || "");
    }

    function restoreInputs(){
      $("name").value = localStorage.getItem(STORAGE_KEYS.name) || "";
      $("birthDate").value = localStorage.getItem(STORAGE_KEYS.date) || "";
      $("birthTime").value = localStorage.getItem(STORAGE_KEYS.time) || "";
    }

    // ====== I18N ======
    const I18N = {
      ar: {
        langLabel: "اللغة",
        shareLabel: "شارك",
        titleBase: "حاسبة العمر المباشر",
        subnote: `أدخل تاريخ ووقت الميلاد ثم شاهد العمر يتحدث كل ثانية.<br>(السنوات/الأشهر تقريبية — بينما الأيام/الساعات/الدقائق/الثواني دقيقة)`,
        lblName: "الاسم",
        phName: "أدخل الاسم",
        hintName: "اختياري. إذا تركته فارغًا سيظهر العنوان العام بدون اسم.",
        lblBirthDate: "تاريخ الميلاد",
        hintBirthDate: "مطلوب. اختر التاريخ من التقويم.",
        lblBirthTime: "ساعة الميلاد",
        hintBirthTime: `اختياري. إذا تركته فارغًا سنعتبر الوقت <b>00:00:00</b>.<br>عادةً الإدخال يكون بنظام <b>24 ساعة</b>: مثال <b>07:30</b> (AM صباحًا) أو <b>19:30</b> (PM مساءً).`,
        btnStart: "احسب العمر",
        btnReset: "مسح",
        rYears: "السنوات (تقريب)",
        rMonths: "الأشهر (تقريب)",
        rWeeks: "الأسابيع",
        rDays: "الأيام",
        rHours: "الساعات",
        rMinutes: "الدقائق",
        rSeconds: "الثواني",
        rHijri: "التاريخ الهجري (أم القرى)",
        hijriHint: "يعرض هذا التاريخ حسب تقويم أم القرى (Umm al-Qura).",
        usefulLinks: "روابط مفيدة:",
        lnkAbout: "من نحن",
        lnkPrivacy: "سياسة الخصوصية",
        lnkContact: "تواصل",
        sumAbout: "من نحن",
        aboutText: "هذه أداة بسيطة لحساب العمر بشكل مباشر (Real-time) عبر إدخال تاريخ ووقت الميلاد. الهدف هو تقديم تجربة سريعة وخفيفة تعمل على الجوال والكمبيوتر.",
        sumContact: "تواصل",
        contactIntro: "إذا عندك اقتراحات أو ملاحظات على الموقع، تواصل معي عبر الوسائل التالية:",
        cNameLbl: "الاسم:",
        cRoleLbl: "الصفة:",
        cEmailLbl: "البريد:",
        cLinkedLbl: "LinkedIn:",
        cLinkedText: "الملف الشخصي",
        alertNeedDate: "يرجى إدخال تاريخ الميلاد",
        alertInvalid: "الرجاء التأكد من صحة تاريخ/وقت الميلاد",
        alertFuture: "تاريخ/وقت الميلاد لا يمكن أن يكون في المستقبل",
        timeEmpty: `سيتم اعتبار الوقت <b>00:00:00</b> إذا تركته فارغًا.`,
        titleFor: (name) => `العمر المباشر لـ ${name}`,
        shareText: "جرب إدخال تاريخ ميلادك لترى عمرك المباشر بالثواني والدقائق والساعات بشكل لحظي.",
        copied: "تم نسخ الرابط. يمكنك لصقه ومشاركته الآن."
      },
      en: {
        langLabel: "Language",
        shareLabel: "Share",
        titleBase: "Live Age Calculator",
        subnote: `Enter birth date and time, then watch your age update every second.<br>(Years/months are approximate — days/hours/minutes/seconds are exact)`,
        lblName: "Name",
        phName: "Enter name",
        hintName: "Optional. If empty, the general title will be shown without a name.",
        lblBirthDate: "Birth date",
        hintBirthDate: "Required. Choose the date from the calendar.",
        lblBirthTime: "Birth time",
        hintBirthTime: `Optional. If empty, time will be set to <b>00:00:00</b>.<br>Input is usually <b>24-hour</b> format: e.g., <b>07:30</b> (AM) or <b>19:30</b> (PM).`,
        btnStart: "Calculate",
        btnReset: "Clear",
        rYears: "Years (approx.)",
        rMonths: "Months (approx.)",
        rWeeks: "Weeks",
        rDays: "Days",
        rHours: "Hours",
        rMinutes: "Minutes",
        rSeconds: "Seconds",
        rHijri: "Hijri date (Umm al-Qura)",
        hijriHint: "This Hijri date is shown using the Umm al-Qura calendar.",
        usefulLinks: "Useful links:",
        lnkAbout: "About",
        lnkPrivacy: "Privacy Policy",
        lnkContact: "Contact",
        sumAbout: "About",
        aboutText: "A lightweight tool to calculate age in real time by entering birth date and time. Designed to work smoothly on mobile and desktop.",
        sumContact: "Contact",
        contactIntro: "For suggestions or feedback, you can reach me via:",
        cNameLbl: "Name:",
        cRoleLbl: "Role:",
        cEmailLbl: "Email:",
        cLinkedLbl: "LinkedIn:",
        cLinkedText: "Profile",
        alertNeedDate: "Please enter your birth date",
        alertInvalid: "Please check the birth date/time values",
        alertFuture: "Birth date/time cannot be in the future",
        timeEmpty: `If left empty, time will be set to <b>00:00:00</b>.`,
        titleFor: (name) => `Live age for ${name}`,
        shareText: "Try entering your birth date to see your live age updating in seconds, minutes, and hours.",
        copied: "Link copied. You can paste and share it now."
      },
      tr: {
        langLabel: "Dil",
        shareLabel: "Paylaş",
        titleBase: "Canlı Yaş Hesaplayıcı",
        subnote: `Doğum tarihi ve saatini girin, yaşınız her saniye güncellensin.<br>(Yıl/ay yaklaşık — gün/saat/dakika/saniye kesin)`,
        lblName: "İsim",
        phName: "İsim girin",
        hintName: "İsteğe bağlı. Boş bırakırsanız genel başlık gösterilir.",
        lblBirthDate: "Doğum tarihi",
        hintBirthDate: "Gerekli. Takvimden tarih seçin.",
        lblBirthTime: "Doğum saati",
        hintBirthTime: `İsteğe bağlı. Boş bırakılırsa saat <b>00:00:00</b> kabul edilir.<br>Giriş genelde <b>24 saat</b> formatıdır: örn. <b>07:30</b> (AM) veya <b>19:30</b> (PM).`,
        btnStart: "Hesapla",
        btnReset: "Temizle",
        rYears: "Yıl (yaklaşık)",
        rMonths: "Ay (yaklaşık)",
        rWeeks: "Hafta",
        rDays: "Gün",
        rHours: "Saat",
        rMinutes: "Dakika",
        rSeconds: "Saniye",
        rHijri: "Hicri tarih (Umm al-Qura)",
        hijriHint: "Hicri tarih, Umm al-Qura takvimine göre gösterilir.",
        usefulLinks: "Bağlantılar:",
        lnkAbout: "Hakkında",
        lnkPrivacy: "Gizlilik Politikası",
        lnkContact: "İletişim",
        sumAbout: "Hakkında",
        aboutText: "Doğum tarihi ve saatini girerek yaşınızı gerçek zamanlı hesaplayan hafif bir araç. Mobil ve masaüstünde sorunsuz çalışır.",
        sumContact: "İletişim",
        contactIntro: "Öneri veya geri bildirim için şu kanallardan ulaşabilirsiniz:",
        cNameLbl: "İsim:",
        cRoleLbl: "Unvan:",
        cEmailLbl: "E-posta:",
        cLinkedLbl: "LinkedIn:",
        cLinkedText: "Profil",
        alertNeedDate: "Lütfen doğum tarihinizi girin",
        alertInvalid: "Lütfen doğum tarihi/saat değerlerini kontrol edin",
        alertFuture: "Doğum tarihi/saat gelecekte olamaz",
        timeEmpty: `Boş bırakılırsa saat <b>00:00:00</b> kabul edilir.`,
        titleFor: (name) => `${name} için canlı yaş`,
        shareText: "Doğum tarihinizi girerek yaşınızı saniye saniye canlı görün.",
        copied: "Bağlantı kopyalandı. Şimdi paylaşabilirsiniz."
      }
    };

    const LANG_META = {
      ar: { dir: "rtl", lang: "ar" },
      en: { dir: "ltr", lang: "en" },
      tr: { dir: "ltr", lang: "tr" }
    };

    let currentLang = "ar";

    function pickInitialLanguage(){
      const saved = localStorage.getItem(STORAGE_KEYS.lang);
      if (saved && I18N[saved]) return saved;

      const urlLang = new URLSearchParams(window.location.search).get("lang");
      if (urlLang && I18N[urlLang]) return urlLang;

      const langs = (navigator.languages && navigator.languages.length)
        ? navigator.languages
        : [navigator.language || "en"];

      const lc = langs.map(x => String(x).toLowerCase());
      if (lc.some(x => x.startsWith("ar"))) return "ar";
      if (lc.some(x => x.startsWith("tr"))) return "tr";
      return "en";
    }

    function setLanguage(lang){
      if (!I18N[lang]) lang = "ar";
      currentLang = lang;
      localStorage.setItem(STORAGE_KEYS.lang, lang);

      document.documentElement.lang = LANG_META[lang].lang;
      document.documentElement.dir = LANG_META[lang].dir;

      const t = I18N[lang];

      $("uiLangLabel").textContent = t.langLabel;
      $("shareLabel").textContent = t.shareLabel;

      $("title").textContent = t.titleBase;
      $("subnote").innerHTML = t.subnote;

      $("lblName").textContent = t.lblName;
      $("name").placeholder = t.phName;
      $("hintName").textContent = t.hintName;

      $("lblBirthDate").textContent = t.lblBirthDate;
      $("hintBirthDate").textContent = t.hintBirthDate;

      $("lblBirthTime").textContent = t.lblBirthTime;
      $("hintBirthTime").innerHTML = t.hintBirthTime;

      $("btnStart").textContent = t.btnStart;
      $("btnReset").textContent = t.btnReset;

      $("rYears").textContent = t.rYears;
      $("rMonths").textContent = t.rMonths;
      $("rWeeks").textContent = t.rWeeks;
      $("rDays").textContent = t.rDays;
      $("rHours").textContent = t.rHours;
      $("rMinutes").textContent = t.rMinutes;
      $("rSeconds").textContent = t.rSeconds;

      $("rHijri").textContent = t.rHijri;
      $("hijriHint").textContent = t.hijriHint;

      $("usefulLinks").textContent = t.usefulLinks;
      $("lnkAbout").textContent = t.lnkAbout;
      $("lnkPrivacy").textContent = t.lnkPrivacy;
      $("lnkContact").textContent = t.lnkContact;

      $("sumAbout").textContent = t.sumAbout;
      $("aboutText").textContent = t.aboutText;

      $("sumContact").textContent = t.sumContact;
      $("contactIntro").textContent = t.contactIntro;

      $("cNameLbl").textContent = t.cNameLbl;
      $("cRoleLbl").textContent = t.cRoleLbl;
      $("cEmailLbl").textContent = t.cEmailLbl;
      $("cLinkedLbl").textContent = t.cLinkedLbl;
      $("cLinkedText").textContent = t.cLinkedText;

      updateTimePreview();
      updateDynamicTitle();

      // إذا كانت النتيجة ظاهرة، حدّث عرض التاريخ الهجري حسب لغة الواجهة
      if ($("result").style.display === "block") {
        const date = $("birthDate").value;
        const time = $("birthTime").value || "00:00:00";
        const birthDateObj = buildLocalDate(date, time);
        if (birthDateObj) $("hijri").textContent = formatHijriUmmAlQura(birthDateObj);
      }
    }

    function updateDynamicTitle(){
      const name = ($("name").value || "").trim();
      const t = I18N[currentLang];
      const isResultVisible = $("result").style.display === "block";

      if (!isResultVisible){
        $("title").textContent = t.titleBase;
        return;
      }
      $("title").textContent = name ? t.titleFor(name) : t.titleBase;
    }

    function updateTimePreview(){
      const preview = $("timePreview");
      if (!preview) return;

      const t = I18N[currentLang];
      const timeVal = ($("birthTime").value || "").trim();

      if (!timeVal){
        preview.innerHTML = t.timeEmpty;
        return;
      }

      const parts = timeVal.split(":").map(Number);
      const hh24 = parts[0] ?? 0;
      const mm = parts[1] ?? 0;

      const isPM = hh24 >= 12;
      let hh12 = hh24 % 12;
      if (hh12 === 0) hh12 = 12;

      const ampm = isPM ? "PM" : "AM";
      const mm2 = String(mm).padStart(2, "0");
      preview.textContent = `${timeVal} = ${hh12}:${mm2} ${ampm}`;
    }

    // ====== Hijri (Umm al-Qura) ======
    function formatHijriUmmAlQura(dateObj){
      const localeMap = {
        ar: "ar-SA-u-ca-islamic-umalqura",
        en: "en-US-u-ca-islamic-umalqura",
        tr: "tr-TR-u-ca-islamic-umalqura"
      };

      const locale = localeMap[currentLang] || localeMap.en;

      try{
        const fmt = new Intl.DateTimeFormat(locale, {
          day: "numeric",
          month: "long",
          year: "numeric"
        });
        return fmt.format(dateObj);
      }catch(e){
        // fallback عام إذا لم يدعم المتصفح umalqura
        try{
          const fmt2 = new Intl.DateTimeFormat((currentLang==="ar" ? "ar" : "en") + "-u-ca-islamic", {
            day: "numeric",
            month: "long",
            year: "numeric"
          });
          return fmt2.format(dateObj);
        }catch(_){
          return (currentLang === "ar") ? "غير مدعوم على هذا المتصفح" : "Not supported on this browser";
        }
      }
    }

    // ====== App logic ======
    function buildLocalDate(dateStr, timeStr){
      const parts = (dateStr || "").split("-").map(Number);
      if (parts.length !== 3 || parts.some(Number.isNaN)) return null;

      const t = (timeStr && timeStr.trim()) ? timeStr.trim() : "00:00:00";
      const tParts = t.split(":").map(Number);
      const hh = tParts[0] ?? 0;
      const mm = tParts[1] ?? 0;
      const ss = tParts[2] ?? 0;

      const y = parts[0], m = parts[1], d = parts[2];
      const dt = new Date(y, m - 1, d, hh, mm, ss);
      if (Number.isNaN(dt.getTime())) return null;
      return dt;
    }

    function resetApp(){
      if (interval) {
        clearInterval(interval);
        interval = null;
      }

      $("result").style.display = "none";
      ["years","months","weeks","days","hours","minutes","seconds"].forEach(id => $(id).textContent = "");
      $("hijri").textContent = "";

      $("name").value = "";
      $("birthDate").value = "";
      $("birthTime").value = "";

      localStorage.removeItem(STORAGE_KEYS.name);
      localStorage.removeItem(STORAGE_KEYS.date);
      localStorage.removeItem(STORAGE_KEYS.time);

      updateTimePreview();
      setLanguage(currentLang);
    }

    function start(){
      const t = I18N[currentLang];

      const name = ($("name").value || "").trim();
      const date = $("birthDate").value;
      const time = $("birthTime").value || "00:00:00";

      if (!date){
        alert(t.alertNeedDate);
        return;
      }

      const birthDate = buildLocalDate(date, time);
      if (!birthDate){
        alert(t.alertInvalid);
        return;
      }

      if (birthDate.getTime() > Date.now()){
        alert(t.alertFuture);
        return;
      }

      saveInputs();

      $("result").style.display = "block";
      updateDynamicTitle();

      // Hijri output (Umm al-Qura)
      $("hijri").textContent = formatHijriUmmAlQura(birthDate);

      if (interval) clearInterval(interval);

      function update(){
        const now = Date.now();
        let diffMs = now - birthDate.getTime();
        if (diffMs < 0) diffMs = 0;

        const seconds = Math.floor(diffMs / 1000);
        const minutes = Math.floor(seconds / 60);
        const hours   = Math.floor(minutes / 60);
        const days    = Math.floor(hours / 24);
        const weeks   = Math.floor(days / 7);

        const yearsApprox  = diffMs / (1000 * 60 * 60 * 24 * 365.2425);
        const monthsApprox = yearsApprox * 12;

        $("years").textContent    = yearsApprox.toFixed(6);
        $("months").textContent   = monthsApprox.toFixed(2);
        $("weeks").textContent    = weeks.toLocaleString();
        $("days").textContent     = days.toLocaleString();
        $("hours").textContent    = hours.toLocaleString();
        $("minutes").textContent  = minutes.toLocaleString();
        $("seconds").textContent  = seconds.toLocaleString();
      }

      update();
      interval = setInterval(update, 1000);
    }

    // ====== Share ======
    function getSharePayload(){
      const t = I18N[currentLang];
      const url = window.location.origin + window.location.pathname; // https://tarekja.github.io/
      const title = t.titleBase;
      const text = t.shareText;
      return { title, text, url };
    }

    async function shareSite(){
      const t = I18N[currentLang];
      const payload = getSharePayload();

      try{
        if (navigator.share){
          await navigator.share(payload);
          return;
        }
      }catch(e){
        // المستخدم قد يلغي المشاركة - لا نعتبره خطأ
        return;
      }

      // Fallback: copy link
      try{
        await navigator.clipboard.writeText(payload.url);
        showToast(t.copied, "ok");
      }catch(e){
        // fallback أقدم: prompt
        window.prompt("Copy link:", payload.url);
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      // منع اختيار تاريخ مستقبلي
      const today = new Date().toISOString().split("T")[0];
      $("birthDate").setAttribute("max", today);

      // Restore inputs
      restoreInputs();

      // Language
      currentLang = pickInitialLanguage();
      $("langSelect").value = currentLang;
      setLanguage(currentLang);

      $("langSelect").addEventListener("change", (e) => {
        setLanguage(e.target.value);
      });

      // Share button
      $("shareBtn").addEventListener("click", shareSite);

      // Time preview
      updateTimePreview();
      $("birthTime").addEventListener("input", updateTimePreview);

      // Auto-save
      ["name","birthDate","birthTime"].forEach(id => {
        $(id).addEventListener("input", () => {
          saveInputs();
          updateDynamicTitle();
        });
      });

      // Auto-start
      if ($("birthDate").value) {
        start();
      }
    });
  </script>
</body>
</html>
