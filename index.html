<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="description" content="حاسبة العمر المباشر بالثواني والدقائق والساعات والأيام. أدخل تاريخ ووقت الميلاد وشاهد العمر يتحدث لحظيًا.">
  <meta name="robots" content="index,follow">
  <meta name="theme-color" content="#0f172a">

  <link rel="canonical" href="https://tarekja.github.io/">
  <link rel="icon" href="favicon.ico">
  <link rel="apple-touch-icon" href="favicon-512.png">

  <meta property="og:title" content="Live Age Calculator | حاسبة العمر المباشر">
  <meta property="og:description" content="احسب عمرك بشكل مباشر بالسنوات والأشهر والأيام والساعات والدقائق والثواني.">
  <meta property="og:url" content="https://tarekja.github.io/">
  <meta property="og:type" content="website">

  <!-- Google Analytics (مرة واحدة فقط) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FZ91MD319E"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-FZ91MD319E', { anonymize_ip: true });
  </script>

  <!-- Google AdSense -->
  <meta name="google-adsense-account" content="ca-pub-3878960602510145">
  <script async
          src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3878960602510145"
          crossorigin="anonymous"></script>

  <title>Live Age Calculator | حاسبة العمر المباشر</title>

  <style>
    :root{
      --bg:#0f172a;
      --panel:#020617;
      --panel2:#0b1226;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --accent:#38bdf8;
      --accent2:#22c55e;
      --danger:#ef4444;
      --border:rgba(148,163,184,.18);
      --shadow:0 16px 40px rgba(0,0,0,.45);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, sans-serif;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 800px at 30% 10%, rgba(56,189,248,.18), transparent 55%),
                  radial-gradient(1000px 700px at 80% 0%, rgba(34,197,94,.14), transparent 55%),
                  linear-gradient(180deg, #020617, #0f172a 35%, #020617);
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px 14px;
    }
    .wrap{
      width: min(920px, 100%);
      display:grid;
      grid-template-columns: 1fr;
      gap:18px;
    }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:16px 16px;
      background: rgba(2,6,23,.55);
      border-bottom:1px solid var(--border);
    }
    .brand{
      display:flex;
      gap:10px;
      align-items:center;
    }
    .logo{
      width:40px; height:40px; border-radius:12px;
      background: radial-gradient(circle at 30% 30%, rgba(56,189,248,.9), rgba(34,197,94,.8));
      box-shadow: 0 8px 18px rgba(0,0,0,.35);
    }
    .brand h1{
      margin:0;
      font-size:16px;
      letter-spacing:.2px;
      font-weight:750;
    }
    .brand p{
      margin:2px 0 0;
      color:var(--muted);
      font-size:12px;
    }
    .controls{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    select, input{
      font: inherit;
      color: var(--text);
      background: rgba(15,23,42,.7);
      border:1px solid var(--border);
      border-radius: 12px;
      padding:10px 12px;
      outline:none;
    }
    select{ cursor:pointer; }
    input::placeholder{ color: rgba(148,163,184,.8); }
    .content{
      padding:18px 16px 16px;
      background: rgba(2,6,23,.25);
    }
    .hero{
      text-align:center;
      padding:10px 6px 16px;
    }
    .hero h2{
      margin:0;
      font-size:22px;
      font-weight:800;
    }
    .hero p{
      margin:8px auto 0;
      color:var(--muted);
      font-size:13px;
      max-width: 560px;
      line-height:1.55;
    }
    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-top:14px;
    }
    @media (max-width: 760px){
      .grid{ grid-template-columns: 1fr; }
      .topbar{ gap:12px; flex-direction:column; align-items:stretch; }
      .controls{ justify-content:space-between; }
    }
    .field{
      background: rgba(2,6,23,.55);
      border:1px solid var(--border);
      border-radius: 16px;
      padding:14px;
    }
    .label{
      font-size:12px;
      color:var(--muted);
      margin:0 0 8px;
    }
    .value{
      font-family: var(--mono);
      font-size:16px;
      letter-spacing:.2px;
      line-height:1.55;
      word-break: break-word;
    }
    .muted{ color: var(--muted); }
    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-top:12px;
    }
    @media (max-width: 760px){
      .row{ grid-template-columns: 1fr; }
    }
    .footer{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding:14px 16px;
      border-top:1px solid var(--border);
      background: rgba(2,6,23,.55);
      color:var(--muted);
      font-size:12px;
      flex-wrap:wrap;
    }
    a{ color: var(--accent); text-decoration:none; }
    a:hover{ text-decoration:underline; }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      border:1px solid var(--border);
      background: rgba(15,23,42,.55);
      padding:8px 10px;
      border-radius: 999px;
      color: var(--text);
      font-size:12px;
      white-space:nowrap;
    }
    .dot{
      width:10px; height:10px; border-radius:999px;
      background: var(--accent2);
      box-shadow: 0 0 0 4px rgba(34,197,94,.12);
    }
    .danger .dot{ background: var(--danger); box-shadow: 0 0 0 4px rgba(239,68,68,.14); }
    .note{
      margin-top:10px;
      padding:12px 14px;
      border-radius: 14px;
      border:1px solid var(--border);
      background: rgba(15,23,42,.45);
      color: var(--muted);
      font-size:12px;
      line-height:1.6;
    }
    .inputs{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:10px;
      margin-top:12px;
    }
    @media (max-width: 900px){
      .inputs{ grid-template-columns: 1fr; }
    }
    .btn{
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(56,189,248,.22), rgba(56,189,248,.10));
      color: var(--text);
      padding:10px 12px;
      border-radius: 12px;
      cursor:pointer;
      transition: transform .05s ease;
    }
    .btn:active{ transform: translateY(1px); }
    .btn.secondary{
      background: rgba(15,23,42,.7);
    }
    .mini{
      font-size:12px;
      color:var(--muted);
      margin-top:6px;
      line-height:1.45;
    }
    .hr{
      height:1px; background: var(--border); margin:14px 0;
    }
    .sectionTitle{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-top:8px;
      margin-bottom:10px;
    }
    .sectionTitle h3{
      margin:0;
      font-size:16px;
      font-weight:800;
    }
  </style>
</head>
<body>

<div class="wrap">

  <div class="card">
    <div class="topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1 data-i18n="appTitle">Live Age Calculator</h1>
          <p data-i18n="appSubtitle">Calculate your live age down to the second.</p>
        </div>
      </div>

      <div class="controls">
        <div class="badge" id="tzBadge" title="Timezone">
          <span class="dot" id="tzDot"></span>
          <span id="tzText">Turkey time</span>
        </div>

        <label class="muted" style="font-size:12px;" for="langSelect" data-i18n="languageLabel">Language</label>
        <select id="langSelect" aria-label="Language">
          <option value="ar">العربية</option>
          <option value="en">English</option>
          <option value="tr">Türkçe</option>
        </select>
      </div>
    </div>

    <div class="content">
      <div class="hero">
        <h2 data-i18n="headline">Live Age Calculator</h2>
        <p data-i18n="lead">
          Enter birth date and time, then watch your age update every second.
          (Years/months are approximate — days/hours/minutes/seconds are exact)
        </p>
      </div>

      <div class="inputs">
        <div>
          <div class="label" data-i18n="nameLabel">Name</div>
          <input id="nameInput" type="text" placeholder="Enter name" />
          <div class="mini" data-i18n="nameHint">Optional. If empty, the general title will be shown without a name.</div>
        </div>
        <div>
          <div class="label" data-i18n="dateLabel">Birth date</div>
          <input id="dateInput" type="date" />
          <div class="mini" data-i18n="dateHint">Required. Choose the date from the calendar.</div>
        </div>
        <div>
          <div class="label" data-i18n="timeLabel">Birth time</div>
          <input id="timeInput" type="time" step="1" />
          <div class="mini" data-i18n="timeHint">Optional. If empty, time is assumed 00:00:00.</div>
        </div>
      </div>

      <div style="display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;">
        <button class="btn" id="startBtn" data-i18n="startBtn">Start</button>
        <button class="btn secondary" id="clearBtn" data-i18n="clearBtn">Clear</button>
      </div>

      <div class="note" id="statusNote">
        <span data-i18n="statusDefault">Fill the fields, then press Start.</span>
      </div>

      <div class="hr"></div>

      <div class="sectionTitle">
        <h3 data-i18n="liveAgeTitle">Your live age</h3>
        <span class="muted" id="nowLabel" style="font-size:12px;"></span>
      </div>

      <div class="grid">
        <div class="field">
          <div class="label" data-i18n="ageExactLabel">Exact</div>
          <div class="value" id="ageExact">—</div>
          <div class="mini muted" data-i18n="ageExactHint">Days / hours / minutes / seconds (exact)</div>
        </div>

        <div class="field">
          <div class="label" data-i18n="ageApproxLabel">Approximate</div>
          <div class="value" id="ageApprox">—</div>
          <div class="mini muted" data-i18n="ageApproxHint">Years / months (approximate)</div>
        </div>
      </div>

      <div class="row">
        <div class="field">
          <div class="label" data-i18n="birthMomentLabel">Birth moment</div>
          <div class="value" id="birthMoment">—</div>
        </div>
        <div class="field">
          <div class="label" data-i18n="nextBirthdayTitle">Next birthday</div>
          <div class="value" id="bdayLeft">—</div>
          <div class="mini">
            <span class="muted" data-i18n="bdayWillBeOn">Your birthday will be on:</span>
            <span id="bdayWill" style="margin-inline-start:6px;">—</span>
          </div>
          <div class="mini">
            <span class="muted" data-i18n="hijriEquivalent">Hijri equivalent:</span>
            <span id="bdayHijri" style="margin-inline-start:6px;">—</span>
          </div>
        </div>
      </div>

      <div class="hr"></div>

      <div class="note">
        <strong data-i18n="noteTitle">Note:</strong>
        <span data-i18n="noteBody">
          This page runs entirely in your browser. We do not send your birth data anywhere.
        </span>
      </div>
    </div>

    <div class="footer">
      <div>
        <span data-i18n="footerLeft">©</span>
        <span id="yearNow"></span>
        <span data-i18n="footerApp">Live Age Calculator</span>
      </div>
      <div>
        <a href="privacy.html" data-i18n="privacyLink">Privacy Policy</a>
      </div>
    </div>
  </div>
</div>

<script>
  const I18N = {
    ar: {
      appTitle: "حاسبة العمر المباشر",
      appSubtitle: "احسب عمرك لحظيًا حتى الثانية.",
      languageLabel: "اللغة",
      headline: "حاسبة العمر المباشر",
      lead: "أدخل تاريخ ووقت الميلاد، ثم شاهد العمر يتحدّث كل ثانية. (السنوات/الأشهر تقديرية — الأيام/الساعات/الدقائق/الثواني دقيقة)",
      nameLabel: "الاسم",
      nameHint: "اختياري. إذا تُرك فارغًا سيظهر العنوان العام دون اسم.",
      dateLabel: "تاريخ الميلاد",
      dateHint: "إلزامي. اختر التاريخ من التقويم.",
      timeLabel: "وقت الميلاد",
      timeHint: "اختياري. إذا تُرك فارغًا سيتم اعتماد 00:00:00.",
      startBtn: "ابدأ",
      clearBtn: "مسح",
      statusDefault: "املأ الحقول ثم اضغط ابدأ.",
      statusRunning: "يتم تحديث العمر كل ثانية…",
      statusMissing: "يرجى إدخال تاريخ الميلاد على الأقل.",
      liveAgeTitle: "عمرك الآن",
      ageExactLabel: "الدقيق",
      ageExactHint: "أيام / ساعات / دقائق / ثوانٍ (دقيق)",
      ageApproxLabel: "التقديري",
      ageApproxHint: "سنوات / أشهر (تقديري)",
      birthMomentLabel: "لحظة الميلاد",
      nextBirthdayTitle: "عيد الميلاد القادم",
      bdayWillBeOn: "سيكون عيد ميلادك في:",
      hijriEquivalent: "الموافق الهجري:",
      noteTitle: "ملاحظة:",
      noteBody: "تعمل الصفحة بالكامل داخل متصفحك. لا يتم إرسال بيانات ميلادك لأي جهة.",
      footerLeft: "©",
      footerApp: "حاسبة العمر المباشر",
      privacyLink: "سياسة الخصوصية",
      tzTurkey: "توقيت تركيا",
      tzLocal: "توقيت جهازك",
      units: { y:"س", mo:"ش", d:"ي", h:"س", m:"د", s:"ث" }
    },
    en: {
      appTitle: "Live Age Calculator",
      appSubtitle: "Calculate your live age down to the second.",
      languageLabel: "Language",
      headline: "Live Age Calculator",
      lead: "Enter birth date and time, then watch your age update every second. (Years/months are approximate — days/hours/minutes/seconds are exact)",
      nameLabel: "Name",
      nameHint: "Optional. If empty, the general title will be shown without a name.",
      dateLabel: "Birth date",
      dateHint: "Required. Choose the date from the calendar.",
      timeLabel: "Birth time",
      timeHint: "Optional. If empty, time is assumed 00:00:00.",
      startBtn: "Start",
      clearBtn: "Clear",
      statusDefault: "Fill the fields, then press Start.",
      statusRunning: "Updating every second…",
      statusMissing: "Please enter at least your birth date.",
      liveAgeTitle: "Your live age",
      ageExactLabel: "Exact",
      ageExactHint: "Days / hours / minutes / seconds (exact)",
      ageApproxLabel: "Approximate",
      ageApproxHint: "Years / months (approximate)",
      birthMomentLabel: "Birth moment",
      nextBirthdayTitle: "Next birthday",
      bdayWillBeOn: "Your birthday will be on:",
      hijriEquivalent: "Hijri equivalent:",
      noteTitle: "Note:",
      noteBody: "This page runs entirely in your browser. We do not send your birth data anywhere.",
      footerLeft: "©",
      footerApp: "Live Age Calculator",
      privacyLink: "Privacy Policy",
      tzTurkey: "Turkey time",
      tzLocal: "Your device time",
      units: { y:"y", mo:"mo", d:"d", h:"h", m:"m", s:"s" }
    },
    tr: {
      appTitle: "Canlı Yaş Hesaplayıcı",
      appSubtitle: "Yaşınızı saniyeye kadar canlı hesaplayın.",
      languageLabel: "Dil",
      headline: "Canlı Yaş Hesaplayıcı",
      lead: "Doğum tarihi ve saatini girin, yaşınız her saniye güncellensin. (Yıl/ay yaklaşık — gün/saat/dakika/saniye kesin)",
      nameLabel: "İsim",
      nameHint: "İsteğe bağlı. Boş bırakırsanız genel başlık görünür.",
      dateLabel: "Doğum tarihi",
      dateHint: "Zorunlu. Takvimden seçin.",
      timeLabel: "Doğum saati",
      timeHint: "İsteğe bağlı. Boşsa 00:00:00 kabul edilir.",
      startBtn: "Başlat",
      clearBtn: "Temizle",
      statusDefault: "Alanları doldurun ve Başlat'a basın.",
      statusRunning: "Her saniye güncelleniyor…",
      statusMissing: "Lütfen en az doğum tarihini girin.",
      liveAgeTitle: "Canlı yaşınız",
      ageExactLabel: "Kesin",
      ageExactHint: "Gün / saat / dakika / saniye (kesin)",
      ageApproxLabel: "Yaklaşık",
      ageApproxHint: "Yıl / ay (yaklaşık)",
      birthMomentLabel: "Doğum anı",
      nextBirthdayTitle: "Bir sonraki doğum günü",
      bdayWillBeOn: "Doğum gününüz:",
      hijriEquivalent: "Hicri karşılığı:",
      noteTitle: "Not:",
      noteBody: "Bu sayfa tamamen tarayıcınızda çalışır. Doğum verileriniz hiçbir yere gönderilmez.",
      footerLeft: "©",
      footerApp: "Canlı Yaş Hesaplayıcı",
      privacyLink: "Gizlilik Politikası",
      tzTurkey: "Türkiye saati",
      tzLocal: "Cihaz saatiniz",
      units: { y:"y", mo:"ay", d:"g", h:"sa", m:"dk", s:"sn" }
    }
  };

  const LANG_META = {
    ar: { dir:"rtl", htmlLang:"ar" },
    en: { dir:"ltr", htmlLang:"en" },
    tr: { dir:"ltr", htmlLang:"tr" }
  };

  let currentLang = localStorage.getItem("lang") || "ar";
  let timer = null;
  let birthDateTime = null;

  const el = (id)=>document.getElementById(id);

  const langSelect = el("langSelect");
  const nameInput = el("nameInput");
  const dateInput = el("dateInput");
  const timeInput = el("timeInput");
  const startBtn = el("startBtn");
  const clearBtn = el("clearBtn");
  const statusNote = el("statusNote");
  const ageExact = el("ageExact");
  const ageApprox = el("ageApprox");
  const birthMoment = el("birthMoment");
  const bdayLeft = el("bdayLeft");
  const bdayWill = el("bdayWill");
  const bdayHijri = el("bdayHijri");
  const nowLabel = el("nowLabel");
  const yearNow = el("yearNow");
  const tzText = el("tzText");

  function applyLang(lang){
    currentLang = lang;
    localStorage.setItem("lang", lang);
    langSelect.value = lang;

    const meta = LANG_META[lang] || LANG_META.en;
    document.documentElement.setAttribute("dir", meta.dir);
    document.documentElement.setAttribute("lang", meta.htmlLang);

    // Translate elements
    document.querySelectorAll("[data-i18n]").forEach(node=>{
      const key = node.getAttribute("data-i18n");
      if(I18N[lang] && I18N[lang][key]){
        node.textContent = I18N[lang][key];
      }
    });

    // Placeholders
    nameInput.placeholder = (lang==="ar") ? "أدخل الاسم" : (lang==="tr" ? "İsim girin" : "Enter name");

    // Update timezone badge label
    tzText.textContent = I18N[lang].tzTurkey;

    // Re-render
    refreshComputedSections(true);
  }

  function formatNumber(n){
    if(n===null || n===undefined || Number.isNaN(n)) return "—";
    return n.toLocaleString(currentLang === "ar" ? "ar" : (currentLang==="tr" ? "tr-TR" : "en-US"));
  }

  function formatDateTimeTR(dt){
    if(!dt) return "—";
    const locale = (currentLang === "ar") ? "ar" : (currentLang === "tr" ? "tr-TR" : "en-US");
    const fmt = new Intl.DateTimeFormat(locale, {
      weekday:"long", year:"numeric", month:"long", day:"numeric",
      hour:"2-digit", minute:"2-digit", second:"2-digit",
      hour12: currentLang === "en"
    });
    return fmt.format(dt);
  }

  function formatHijriIstanbul(dt){
    try{
      const locale = (currentLang === "tr") ? "tr-TR" : (currentLang === "ar" ? "ar" : "en-US");
      const fmt = new Intl.DateTimeFormat(locale + "-u-ca-islamic-umalqura", {
        day:"numeric", month:"long", year:"numeric",
        timeZone:"Europe/Istanbul"
      });
      return fmt.format(dt);
    }catch(e){
      return "—";
    }
  }

  function nowIstanbul(){
    // Istanbul/Turkey time
    const now = new Date();
    const parts = new Intl.DateTimeFormat("en-US", {
      timeZone: "Europe/Istanbul",
      year:"numeric", month:"2-digit", day:"2-digit",
      hour:"2-digit", minute:"2-digit", second:"2-digit",
      hour12:false
    }).formatToParts(now);
    const map = {};
    parts.forEach(p=>{ if(p.type!=="literal") map[p.type]=p.value; });
    return new Date(`${map.year}-${map.month}-${map.day}T${map.hour}:${map.minute}:${map.second}`);
  }

  function getNextBirthdayDate(birth){
    const now = nowIstanbul();
    const y = now.getFullYear();
    const month = birth.getMonth();
    const day = birth.getDate();
    const timeH = birth.getHours();
    const timeM = birth.getMinutes();
    const timeS = birth.getSeconds();

    let next = new Date(y, month, day, timeH, timeM, timeS);
    if(next.getTime() <= now.getTime()){
      next = new Date(y+1, month, day, timeH, timeM, timeS);
    }
    return next;
  }

  function formatCountdown(ms){
    if(ms<=0) return "0";
    const t = I18N[currentLang].units;

    const totalSeconds = Math.floor(ms / 1000);
    const s = totalSeconds % 60;
    const totalMinutes = Math.floor(totalSeconds / 60);
    const m = totalMinutes % 60;
    const totalHours = Math.floor(totalMinutes / 60);
    const h = totalHours % 24;
    const totalDays = Math.floor(totalHours / 24);

    const mo = Math.floor(totalDays / 30);
    const d = totalDays % 30;

    return `${formatNumber(mo)} ${t.mo} - ${formatNumber(d)} ${t.d} - ${formatNumber(h)} ${t.h} - ${formatNumber(m)} ${t.m} - ${formatNumber(s)} ${t.s}`;
  }

  function renderAge(){
    if(!birthDateTime) return;

    const now = nowIstanbul();
    const diffMs = now - birthDateTime;
    if(diffMs < 0) return;

    const diffSeconds = Math.floor(diffMs / 1000);
    const seconds = diffSeconds % 60;
    const diffMinutes = Math.floor(diffSeconds / 60);
    const minutes = diffMinutes % 60;
    const diffHours = Math.floor(diffMinutes / 60);
    const hours = diffHours % 24;
    const days = Math.floor(diffHours / 24);

    // approximate years/months
    const yearsApprox = Math.floor(days / 365.2425);
    const monthsApprox = Math.floor((days - yearsApprox*365.2425) / 30.436875);

    const t = I18N[currentLang].units;

    ageExact.textContent = `${formatNumber(days)} ${t.d} - ${formatNumber(hours)} ${t.h} - ${formatNumber(minutes)} ${t.m} - ${formatNumber(seconds)} ${t.s}`;
    ageApprox.textContent = `${formatNumber(yearsApprox)} ${t.y} - ${formatNumber(monthsApprox)} ${t.mo}`;

    const name = nameInput.value.trim();
    const titleKey = "headline";
    const baseTitle = I18N[currentLang][titleKey] || "Live Age Calculator";
    document.title = name ? `${baseTitle} — ${name}` : baseTitle;

    nowLabel.textContent = formatDateTimeTR(now);
  }

  function renderNextBirthday(){
    if(!birthDateTime) return;

    const now = nowIstanbul();
    const next = getNextBirthdayDate(birthDateTime);
    const leftMs = next - now;

    bdayLeft.textContent = formatCountdown(leftMs);
    bdayWill.textContent = formatDateTimeTR(next);
    bdayHijri.textContent = formatHijriIstanbul(next);
  }

  function refreshComputedSections(force){
    if(!birthDateTime){
      ageExact.textContent = "—";
      ageApprox.textContent = "—";
      birthMoment.textContent = "—";
      bdayLeft.textContent = "—";
      bdayWill.textContent = "—";
      bdayHijri.textContent = "—";
      nowLabel.textContent = "";
      return;
    }
    birthMoment.textContent = formatDateTimeTR(birthDateTime);
    renderAge();
    renderNextBirthday();
  }

  function start(){
    const d = dateInput.value;
    if(!d){
      statusNote.innerHTML = `<span data-i18n="statusMissing">${I18N[currentLang].statusMissing}</span>`;
      return;
    }
    const t = timeInput.value || "00:00:00";
    const safeTime = (t.length === 5) ? (t + ":00") : t; // HH:MM -> HH:MM:SS
    birthDateTime = new Date(`${d}T${safeTime}`);

    statusNote.innerHTML = `<span data-i18n="statusRunning">${I18N[currentLang].statusRunning}</span>`;

    if(timer) clearInterval(timer);
    timer = setInterval(()=>{
      refreshComputedSections(false);
    }, 1000);

    refreshComputedSections(true);
  }

  function clearAll(){
    if(timer) clearInterval(timer);
    timer = null;
    birthDateTime = null;
    nameInput.value = "";
    dateInput.value = "";
    timeInput.value = "";
    statusNote.innerHTML = `<span data-i18n="statusDefault">${I18N[currentLang].statusDefault}</span>`;
    refreshComputedSections(true);
  }

  langSelect.addEventListener("change", ()=> applyLang(langSelect.value));
  startBtn.addEventListener("click", start);
  clearBtn.addEventListener("click", clearAll);

  yearNow.textContent = new Date().getFullYear();

  // Init
  applyLang(currentLang);
  tzText.textContent = I18N[currentLang].tzTurkey;
  statusNote.innerHTML = `<span data-i18n="statusDefault">${I18N[currentLang].statusDefault}</span>`;
</script>

</body>
</html>
